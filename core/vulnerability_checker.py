"""
NetMonitor
Author: Abdullah Ahmed
Year: 2026
Second-Year Cybersecurity Student Project
All Rights Reserved.

This software is free for academic and personal use.
Commercial usage or redistribution requires explicit permission from the author.
"""

class VulnerabilityChecker:
    """
    Checks for high-risk ports and generates security alerts.
    """
    RISKY_PORTS = {
        21: "FTP - File Transfer Protocol (Unencrypted)",
        23: "Telnet - Remote Access (Unencrypted)",
        445: "SMB - Server Message Block (WannaCry Target)",
        3389: "RDP - Remote Desktop Protocol (Brute Force Target)"
    }

    def check_vulnerabilities(self, ip, open_ports):
        """
        Analyzes open ports and returns a list of vulnerability alerts.
        """
        alerts = []
        
        for port in open_ports:
            if port in self.RISKY_PORTS:
                alerts.append({
                    "ip": ip,
                    "port": port,
                    "description": self.RISKY_PORTS[port],
                    "severity": "High" if port in [445, 3389] else "Medium"
                })
        
        return alerts
